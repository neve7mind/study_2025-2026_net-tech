---
## Author
author:
  name: Мурашов Иван Вячеславович
  email: 1132236018@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Отчёт по лабораторной работе №6"
subtitle: "Сетевые технологии"
license: "CC BY"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
---

# Цель работы

Цель данной работы — изучение принципов распределения и настройки адресного пространства на устройствах сети.

# Выполнение лабораторной работы

## Разбиение сети на подсети

Задана IPv4-сеть 172.16.20.0/24. Распишем характеристики ([рис. @fig-001]).

![Таблица характеристик сети](image/1.png){#fig-001 width=70%}

В случае подсети со 126 узлами мы имеем 128 адресов (+2 на broadcast и на адрес самой сети). Маска подсети: 255.255.255.128. Broadcast адрес: 172.16.20.127. (префикс /25)  Диапазон адресов: 172.16.20.1 – 172.16.20.126.
Для последующих двух подсетей имеем 64 (+2) адреса. Маска подсети: 255.255.255.192. (префикс /26)  Broadcast адрес подсети 2: 172.16.20.191.  Диапазон адресов подсети 2: 172.16.20.129 – 172.16.20.190.
Broadcast адрес подсети 2: 172.16.20.255. (префикс /26)  Диапазон адресов подсети 3: 172.16.20.193 – 172.16.20.254.

Задана сеть 10.10.1.64/26. Распишем характеристики ([рис. @fig-002]).

![Таблица характеристик сети](image/2.png){#fig-002 width=70%}

Нам потребуется 30+2=32 адреса. Маска подсети: 255.255.255.224 (префикс 32-log(2)32 = 27). Broadcast адрес: 10.10.1.95.  Диапазон адресов: 10.10.1.65 – 10.10.1.94. 

Задана сеть 10.10.1.0/26. Распишем характеристики ([рис. @fig-003]).

![Таблица характеристик сети](image/3.png){#fig-003 width=70%}

Нам потребуется 14+2=16 адреса. Маска подсети: 255.255.255.240 (префикс /28). Broadcast адрес: 10.10.1.15.  Диапазон адресов: 10.10.1.1 – 10.10.1.14. 

Задана сеть 2001:db8:c0de::/48. Распишем характеристики ([рис. @fig-004]).

![Таблица характеристик сети](image/4.png){#fig-004 width=70%}

Разобьём сеть на 2 подсети.
Способ с использованием идентификатора подсети:
Позаимствуем 1 бит из SubnetID, получим префикс /49. Таким образом, получим подсети 2001:db8:c0de::/49 и 2001:db8:c0de:8000::/49.

Способ с использованием идентификатора интерфейса:
Позаимствуем 1 бит из InterfaceID, получим префикс /65. Таким образом, получим подсети 2001:db8:c0de::/65 и 2001:db8:c0de:0000:8000::/65.

## Настройка двойного стека адресации IPv4 и IPv6 в локальной сети

Задана топология сети с двумя локальными подсетями. Для первой подсети выделено адресное пространство с адресами IPv4, для второй — адресное пространство с адресами IPv6. Построим её в GNS3 ([рис. @fig-005]).

![Топология сети с двумя локальными подсетями](image/5.png){#fig-005 width=70%}

Настроим IPv4-адресацию для интерфейсов узлов PC1, PC2, Server и просмотрим конфигурацию IPv4 и IPv6 ([рис. @fig-006], [рис. @fig-007], [рис. @fig-008]).

![Консоль VPCS (PC1)](image/6.png){#fig-006 width=70%}

![Консоль VPCS (PC2)](image/7.png){#fig-007 width=70%}

![Консоль VPCS (Server)](image/8.png){#fig-008 width=70%}

Настроим IPv4-адресацию для интерфейсов локальной сети маршрутизатора FRR msk-ivmurashov-gw-01 ([рис. @fig-009]).

![Консоль FRR](image/9.png){#fig-009 width=70%}

Проверяем конфигурацию маршрутизатора и настройки IPv4-адресации ([рис. @fig-010]).

![Консоль FRR](image/10.png){#fig-010 width=70%}

Проверьте подключение с помощью команд ping и trace. Узлы PC1 и PC2 успешно отправляют эхо-запросы друг другу ([рис. @fig-011]).

![Ping PC1 и PC2](image/11.png){#fig-011 width=70%}

Настроим IPv6-адресацию для интерфейсов узлов PC3, PC4, Server и просмотрим конфигурацию IPv4 и IPv6 ([рис. @fig-012], [рис. @fig-013], [рис. @fig-014]).

![Консоль VPCS (PC1)](image/12.png){#fig-012 width=70%}

![Консоль VPCS (PC2)](image/13.png){#fig-013 width=70%}

![Консоль VPCS (Server)](image/14.png){#fig-014 width=70%}

Настроим IPv6-адресацию для интерфейсов локальной сети маршрутизатора VyOS msk-ivmurashov-gw-02. Перейдём в режим конфигурирования и изменим имя устройства ([рис. @fig-015]).

![Консоль VyOS](image/15.png){#fig-015 width=70%}

Назначим IPv6-адреса маршрутизатору msk-ivmurashov-gw-02 ([рис. @fig-016]).

![Консоль VyOS](image/16.png){#fig-016 width=70%}

Проверьте подключение с помощью команд ping и trace на узлах PC1, PC2, PC3, PC4 ([рис. @fig-017], [рис. @fig-018]).

![Ping PC1 и PC2](image/17.png){#fig-017 width=70%}

![Ping PC3 и PC4](image/18.png){#fig-018 width=70%}

Убедимся, что устройства из подсети IPv4 не доступны для устройств из подсети IPv6 и наоборот. Только сервер двойного стека может обращаться к устройствам обеих подсетей ([рис. @fig-019], [рис. @fig-020], [рис. @fig-021]).

![Ping PC3 с PC1 и наоборот](image/19.png){#fig-019 width=70%}

![Ping PC4 с PC2 и наоборот](image/20.png){#fig-020 width=70%}

![Ping всех PC с Server](image/21.png){#fig-021 width=70%}

## Задание для самостоятельного выполнения

Задана топология сети. Предполагается, что маршрутизатор разбивает сеть на две подсети с адресами
IPv4 и IPv6:
– подсеть 1: 10.10.1.96/27; 2001:DB8:1:1::/64;
– подсеть 2: 10.10.1.16/28; 2001:DB8:1:4::/64.

Составим схему согласно топологии в GNS3 ([рис. @fig-022]).

![Топология сети с двумя локальными подсетями](image/22.png){#fig-022 width=70%}

Назначим PC1 IPv4-адрес 10.10.1.98/27 и IPv6-адрес 2001:db8:1:1::2/64, проверим, что все адреса корректно заданы ([рис. @fig-023]).

![Консоль VPCS (PC1)](image/23.png){#fig-023 width=70%}

Назначим PC2 IPv4-адрес 10.10.1.18/28 и IPv6-адрес 2001:db8:1:4::2/64, проверим, что все адреса корректно заданы ([рис. @fig-024]).

![Консоль VPCS (PC2)](image/24.png){#fig-024 width=70%}

Затем сконфигурируем VyOS, настроив адреса на сетевых интерфейсах eth0, eth1 и проверив, какие изменения мы внесли ([рис. @fig-025]).

![Консоль VyOS](image/25.png){#fig-025 width=70%}

Проверим, что PC2 недоступен с PC1 ([рис. @fig-026]).

![Консоль VPCS (PC1)](image/26.png){#fig-026 width=70%}

Проверим, что PC1 недоступен с PC2 ([рис. @fig-027).

![Консоль VPCS (PC2)](image/27.png){#fig-027 width=70%}

Проверим, что все хосты доступны с VyOS ([рис. @fig-028).

![Консоль VyOS](image/28.png){#fig-028 width=70%}

# Выводы

В ходе данной лабораторной работы мной были изучены принципы распределения и приобретены навыки по настройке адресного пространства на устройствах сети.

