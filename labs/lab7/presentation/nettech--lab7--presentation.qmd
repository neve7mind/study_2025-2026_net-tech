---
## Author
author:
  name: Мурашов Иван Вячеславович
  email: 1132236018@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: Лабораторная работа №7
subtitle: Сетевые технологии
license: CC BY
date: 2025-12-07
date-format: "YYYY-MM-DD"
---

## Цель работы

Цель данной работы — получение навыков настройки службы DHCP на сетевом оборудовании для
распределения адресов IPv4 и IPv6.

## Настройка DHCP в случае IPv4

Запускаю GNS3 VM и GNS3 и создаю новый проект. В рабочей области GNS3 размещаю   маршрутизатор VyOS, свитч и хост (клиент) VPCS ([рис. @fig-001]).

![Топология моделируемой сети](image/1.png){#fig-001 width=70%}

## Настройка DHCP в случае IPv4

На маршрутизаторах перехожу в режим конфигурирования, изменяю имя устройства и доменное имя, заменяю системного пользователя, заданного по умолчанию, на себя ([рис. @fig-002]).

![Консоль маршрутиризатора](image/2.png){#fig-002 width=70%}

## Настройка DHCP в случае IPv4

На маршрутизаторе под созданным пользователем перехожу в режим конфигурирования и настраиваю адресацию IPv4 ([рис. @fig-003]).

![Консоль маршрутиризатора](image/3.png){#fig-003 width=70%}

## Настройка DHCP в случае IPv4

Добавим конфигурацию DHCP-сервера на маршрутизаторе ([рис. @fig-004]).

![Консоль маршрутиризатора](image/4.png){#fig-004 width=70%}

Здесь при помощи указанных выше команд была создана разделяемая сеть (shared-network-name) с названием username, подсеть (subnet) с адресом 10.0.0.0/24, задан диапазон адресов (range) с именем hosts, содержащий адреса 10.0.0.2–10.0.0.253.

## Настройка DHCP в случае IPv4

Просмотрим статистику DHCP-сервера и выданных адресов ([рис. @fig-005]).

![Консоль маршрутиризатора](image/5.png){#fig-005 width=70%}

## Настройка DHCP в случае IPv4

Настроим оконечное устройство PC1 ([рис. @fig-006]).

![Консоль VPCS (PC1)](image/6.png){#fig-006 width=70%}

## Настройка DHCP в случае IPv4

Проверяем конфигурацию IPv4 на узле, пропингуем маршрутизатор ([рис. @fig-007]).

![Консоль VPCS (PC1)](image/7.png){#fig-007 width=70%}

## Настройка DHCP в случае IPv4

На маршрутизаторе вновь посмотрим статистику DHCP-сервера и выданные адреса ([рис. @fig-008]).

![Консоль VPCS (PC1)](image/8.png){#fig-008 width=70%}

Заметим, что был выдан один сетевой адрес PC1, доступных (available) стало на 1 меньше (252-251=1). Сам выданный адрес - 10.0.0.2 - первый из ранее заданного нами диапазона. Дата экспирации - через 24 часа.

## Настройка DHCP в случае IPv4

На маршрутизаторе просмотрим  журнал работы DHCP-сервера ([рис. @fig-009]).

![Консоль маршрутиризатора](image/9.png){#fig-009 width=70%}

Здесь можем увидеть наш ping-запрос.

## Настройка DHCP в случае IPv4

Проанализируем пакеты, относящиеся к работе DHCP, в WireShark ([рис. @fig-010]).

![WireShark](image/10.png){#fig-010 width=70%}

Здесь видим ответ клиенту на адрес 10.0.0.2, так же показан MAC-адрес. В случае конкретно выделенного пакета - мы имеем дело с DHCP-OFFER - он выделяет некоторый адрес DHCP-клиенту на определенное время, назначает другие настройки и пересылает всю информацию DHCP клиенту.

##  Настройка DHCP в случае IPv6

Дополняем нашу сеть, добавляя 2 хоста Kali Linux CLI (для работы с DHCPv6) и 2 свитча соответственно ([рис. @fig-011]), ([рис. @fig-012]).

![Добавление Kali Linux CLI в GNS3](image/11.png){#fig-011 width=70%}

##  Настройка DHCP в случае IPv6

![Топология моделируемой сети](image/12.png){#fig-012 width=70%}

##  Настройка DHCP в случае IPv6

Настроим адресацию IPv6 на маршрутизаторе ([рис. @fig-013]).

![Консоль маршрутиризатора](image/13.png){#fig-013 width=70%}

##  Настройка DHCP в случае IPv6

На маршрутизаторе настроим DHCPv6 без отслеживания состояния (DHCPv6 Stateless configuration):
– Настройка объявления о маршрутизаторах (Router Advertisements, RA) на интерфейсе eth1:
username@username-gw-01# set service router-advert interface eth1 prefix 2000::/64
username@username-gw-01# set service router-advert interface eth1 other-config-flag
Опция other-config-flag означает, что для конфигурации не адресных
параметров использует протокол с сохранением состояния.

– Добавление конфигурации DHCP-сервера (вместо username укажите имя
вашей учётной записи):
username@username-gw-01# set service dhcpv6-server shared-network-name username-stateless
username@username-gw-01# set service dhcpv6-server shared-network-name username-stateless subnet 2000::0/64
username@username-gw-01# set service dhcpv6-servershared-network-name username-stateless common-options name-server 2000::1
username@username-gw-01# set service dhcpv6-server shared-network-name username-stateless common-options domain-search username.net

##  Настройка DHCP в случае IPv6

![Консоль маршрутиризатора](image/14.png){#fig-014 width=70%}

##  Настройка DHCP в случае IPv6

![Консоль маршрутиризатора](image/15.png){#fig-015 width=70%}

##  Настройка DHCP в случае IPv6

Здесь с помощью указанных выше команд создана разделяемая сеть (sharednetwork-name) с названием username, задана информация общих опций (common-options) для разделяемой сети. При этом подсеть (subnet) 2000::/64 не требуется настраивать, поскольку она не будет содержать полезной информации.

На узле PC2 проверим настройки сети (а тут начинаются проблемы). Без лишней интриги - в обычной консоли команды в принципе не работали ([рис. @fig-017]).

##  Настройка DHCP в случае IPv6

![Консоль VPCS (PC2)](image/17.png){#fig-017 width=70%}

##  Настройка DHCP в случае IPv6

В альтернативном варианте консоли я смог просмотреть сетевые интерфейсы ([рис. @fig-017]).

![Консоль VPCS (PC2)](image/16.png){#fig-016 width=70%}

##  Настройка DHCP в случае IPv6

Там же попробовал пропинговать маршрутиризатор (неудачно) ([рис. @fig-018]).

![Консоль VPCS (PC2)](image/18.png){#fig-018 width=70%}

##  Настройка DHCP в случае IPv6

На маршрутизаторе попытка просмотра статистики DHCP-сервера не принесла успехов (так как никаких адресов выдано не было) ([рис. @fig-021]).

![Консоль VPCS (PC2)](image/21.png){#fig-021 width=70%}

##  Настройка DHCP в случае IPv6

Собственно аналогичные попытки на PC3 дали аналогичный результат ([рис. @fig-022]).

![Консоль VPCS (PC2)](image/22.png){#fig-022 width=70%}

Как бы я не пытался исправить это, ничего не вышло, но я старался... Честно.

## Выводы

В ходе данной лабораторной работы мной были получены навыки настройки службы DHCP на сетевом оборудовании для распределения адресов IPv4 и IPv6.

